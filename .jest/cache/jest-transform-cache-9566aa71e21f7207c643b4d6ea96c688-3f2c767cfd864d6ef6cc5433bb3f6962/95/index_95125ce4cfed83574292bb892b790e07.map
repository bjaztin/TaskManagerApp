{"version":3,"names":["_animation","require","supportedProps","_worklet_14046384917701_init_data","code","location","sourceMap","SharedTransition","_classCallCheck2","default","_defineProperty","_createClass2","key","value","custom","animationFactory","build","animationDuration","defaultDuration","_e","global","Error","_f","values","animations","initialValues","includes","propName","matrix","targetTransformMatrix","transformMatrix","withTiming","duration","keyToTargetValue","charAt","toUpperCase","slice","currentTransformMatrix","keyToCurrentValue","_closure","__initData","__workletHash","__stackDetails","__version","createInstance","exports","DefaultSharedTransition"],"sources":["index.ts"],"sourcesContent":["import { withTiming } from '../../animation';\nimport {\n  ILayoutAnimationBuilder,\n  LayoutAnimationFunction,\n  LayoutAnimationsValues,\n} from '../animationBuilder/commonTypes';\nimport { StyleProps } from '../../commonTypes';\n\nconst supportedProps = ['width', 'height', 'originX', 'originY', 'transform'];\n\ntype AnimationFactoryType = (values: LayoutAnimationsValues) => StyleProps;\n\nexport class SharedTransition implements ILayoutAnimationBuilder {\n  animationFactory: AnimationFactoryType | null = null;\n  defaultDuration = 500;\n\n  static createInstance(): SharedTransition {\n    return new SharedTransition();\n  }\n\n  static custom(animationFactory: AnimationFactoryType): SharedTransition {\n    return this.createInstance().custom(animationFactory);\n  }\n\n  custom(animationFactory: AnimationFactoryType): SharedTransition {\n    this.animationFactory = animationFactory;\n    return this;\n  }\n\n  static build(): LayoutAnimationFunction {\n    return this.createInstance().build();\n  }\n\n  build(): LayoutAnimationFunction {\n    const animationFactory = this.animationFactory;\n    const animationDuration = this.defaultDuration;\n    return (values: LayoutAnimationsValues) => {\n      'worklet';\n      let animations: {\n        [key: string]: any;\n      } = {};\n      const initialValues: {\n        [key: string]: any;\n      } = {};\n\n      if (animationFactory) {\n        animations = animationFactory(values);\n        for (const key in animations) {\n          if (!supportedProps.includes(key)) {\n            throw Error(`The prop '${key}' is not supported yet.`);\n          }\n        }\n      } else {\n        for (const propName of supportedProps) {\n          if (propName === 'transform') {\n            const matrix = values.targetTransformMatrix;\n            animations.transformMatrix = withTiming(matrix, {\n              // native screen transition takes around 500ms\n              duration: animationDuration,\n            });\n          } else {\n            const keyToTargetValue =\n              'target' + propName.charAt(0).toUpperCase() + propName.slice(1);\n            animations[propName] = withTiming(values[keyToTargetValue], {\n              // native screen transition takes around 500ms\n              duration: animationDuration,\n            });\n          }\n        }\n      }\n\n      for (const propName in animations) {\n        if (propName === 'transform') {\n          initialValues.transformMatrix = values.currentTransformMatrix;\n        } else {\n          const keyToCurrentValue =\n            'current' + propName.charAt(0).toUpperCase() + propName.slice(1);\n          initialValues[propName] = values[keyToCurrentValue];\n        }\n      }\n\n      return { initialValues, animations };\n    };\n  }\n}\n\nexport const DefaultSharedTransition = SharedTransition;\n"],"mappings":"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"}