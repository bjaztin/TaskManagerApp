{"version":3,"names":["_xdate","_interopRequireDefault","require","_react","_interopRequireWildcard","_reactNative","_services","_interface","_dateutils","_commons","_style","_index","_jsxRuntime","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","TOP_POSITION","DOWN_ICON","UP_ICON","TodayButton","props","ref","useImperativeHandle","disable","shouldDisable","_props$margin","margin","_props$disabledOpacit","disabledOpacity","theme","propsStyle","style","_useContext","useContext","Context","date","setDate","_useState","useState","_useState2","_slicedToArray2","disabled","setDisabled","useRef","styleConstructor","state","isToday","isPastDate","shouldShow","useEffect","setButtonIcon","getButtonIcon","animatePosition","animateOpacity","getFormattedLabel","todayStr","getDefaultLocale","today","todayString","charAt","toUpperCase","slice","_useState3","_useState4","buttonIcon","buttonY","Animated","Value","opacity","getPositionAnimation","toValue","tension","friction","useNativeDriver","getOpacityAnimation","duration","animationData","spring","current","start","timing","getTodayDate","toMarkingFormat","XDate","onPress","useCallback","UpdateSources","TODAY_PRESS","jsx","View","todayButtonContainer","transform","translateY","children","jsxs","TouchableOpacity","todayButton","Image","todayButtonImage","source","Text","allowFontScaling","todayButtonText","_default","forwardRef","exports"],"sources":["todayButton.js"],"sourcesContent":["import XDate from 'xdate';\nimport React, { forwardRef, useImperativeHandle, useEffect, useRef, useState, useContext, useCallback } from 'react';\nimport { Animated, TouchableOpacity } from 'react-native';\nimport { getDefaultLocale } from '../../services';\nimport { toMarkingFormat } from '../../interface';\nimport { isToday, isPastDate } from '../../dateutils';\nimport { UpdateSources, todayString } from '../commons';\nimport styleConstructor from '../style';\nimport Context from './index';\nconst TOP_POSITION = 65;\nconst DOWN_ICON = require('../../img/down.png');\nconst UP_ICON = require('../../img/up.png');\nconst TodayButton = (props, ref) => {\n    useImperativeHandle(ref, () => ({\n        disable: (shouldDisable) => {\n            disable(shouldDisable);\n        }\n    }));\n    const { margin = 0, disabledOpacity = 0.3, theme, style: propsStyle, } = props;\n    const { date, setDate } = useContext(Context);\n    const [disabled, setDisabled] = useState(false);\n    const style = useRef(styleConstructor(theme));\n    const state = isToday(date) ? 0 : isPastDate(date) ? -1 : 1;\n    const shouldShow = state !== 0;\n    /** Effects */\n    useEffect(() => {\n        if (shouldShow) {\n            setButtonIcon(getButtonIcon());\n        }\n        animatePosition();\n    }, [state]);\n    useEffect(() => {\n        if (!shouldShow) {\n            return;\n        }\n        animateOpacity();\n    }, [disabled]);\n    const disable = (shouldDisable) => {\n        if (shouldDisable !== disabled) {\n            setDisabled(shouldDisable);\n        }\n    };\n    /** Label */\n    const getFormattedLabel = () => {\n        const todayStr = getDefaultLocale().today || todayString;\n        const today = todayStr.charAt(0).toUpperCase() + todayStr.slice(1);\n        return today;\n    };\n    const today = useRef(getFormattedLabel());\n    /** Icon */\n    const getButtonIcon = () => {\n        if (shouldShow) {\n            return state === 1 ? UP_ICON : DOWN_ICON;\n        }\n    };\n    const [buttonIcon, setButtonIcon] = useState(getButtonIcon());\n    /** Animations */\n    const buttonY = useRef(new Animated.Value(margin ? -margin : -TOP_POSITION));\n    const opacity = useRef(new Animated.Value(1));\n    const getPositionAnimation = () => {\n        const toValue = state === 0 ? TOP_POSITION : -margin || -TOP_POSITION;\n        return {\n            toValue,\n            tension: 30,\n            friction: 8,\n            useNativeDriver: true\n        };\n    };\n    const getOpacityAnimation = () => {\n        return {\n            toValue: disabled ? disabledOpacity : 1,\n            duration: 500,\n            useNativeDriver: true\n        };\n    };\n    const animatePosition = () => {\n        const animationData = getPositionAnimation();\n        Animated.spring(buttonY.current, {\n            ...animationData\n        }).start();\n    };\n    const animateOpacity = () => {\n        const animationData = getOpacityAnimation();\n        Animated.timing(opacity.current, {\n            ...animationData\n        }).start();\n    };\n    const getTodayDate = () => {\n        return toMarkingFormat(new XDate());\n    };\n    const onPress = useCallback(() => {\n        setDate(getTodayDate(), UpdateSources.TODAY_PRESS);\n    }, [setDate]);\n    return (<Animated.View style={[style.current.todayButtonContainer, { transform: [{ translateY: buttonY.current }] }]}>\n      <TouchableOpacity style={[style.current.todayButton, propsStyle]} onPress={onPress} disabled={disabled}>\n        <Animated.Image style={[style.current.todayButtonImage, { opacity: opacity.current }]} source={buttonIcon}/>\n        <Animated.Text allowFontScaling={false} style={[style.current.todayButtonText, { opacity: opacity.current }]}>\n          {today.current}\n        </Animated.Text>\n      </TouchableOpacity>\n    </Animated.View>);\n};\nexport default forwardRef(TodayButton);\n"],"mappings":"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"}