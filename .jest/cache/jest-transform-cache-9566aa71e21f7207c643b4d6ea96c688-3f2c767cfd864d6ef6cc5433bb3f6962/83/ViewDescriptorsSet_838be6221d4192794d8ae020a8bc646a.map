{"version":3,"names":["_react","require","_core","_worklet_377781867727_init_data","code","location","sourceMap","_worklet_253806177609_init_data","makeViewDescriptorsSet","sharableViewDescriptors","makeMutable","data","add","item","modify","_e","global","Error","_f","descriptors","index","findIndex","descriptor","tag","push","_closure","__initData","__workletHash","__stackDetails","__version","remove","viewTag","splice","makeViewsRefSet","ref","useRef","current","items","Set","has","delete"],"sources":["ViewDescriptorsSet.ts"],"sourcesContent":["import { useRef } from 'react';\nimport { makeMutable } from './core';\nimport { SharedValue } from './commonTypes';\nimport { Descriptor } from './hook/commonTypes';\n\nexport interface ViewRefSet<T> {\n  items: Set<T>;\n  add: (item: T) => void;\n  remove: (item: T) => void;\n}\n\nexport interface ViewDescriptorsSet {\n  sharableViewDescriptors: SharedValue<Descriptor[]>;\n  add: (item: Descriptor) => void;\n  remove: (viewTag: number) => void;\n}\n\nexport function makeViewDescriptorsSet(): ViewDescriptorsSet {\n  const sharableViewDescriptors = makeMutable<Descriptor[]>([]);\n  const data: ViewDescriptorsSet = {\n    sharableViewDescriptors,\n    add: (item: Descriptor) => {\n      sharableViewDescriptors.modify((descriptors: Descriptor[]) => {\n        'worklet';\n        const index = descriptors.findIndex(\n          (descriptor) => descriptor.tag === item.tag\n        );\n        if (index !== -1) {\n          descriptors[index] = item;\n        } else {\n          descriptors.push(item);\n        }\n        return descriptors;\n      });\n    },\n\n    remove: (viewTag: number) => {\n      sharableViewDescriptors.modify((descriptors: Descriptor[]) => {\n        'worklet';\n        const index = descriptors.findIndex(\n          (descriptor) => descriptor.tag === viewTag\n        );\n        if (index !== -1) {\n          descriptors.splice(index, 1);\n        }\n        return descriptors;\n      });\n    },\n  };\n  return data;\n}\n\nexport function makeViewsRefSet<T>(): ViewRefSet<T> {\n  const ref = useRef<ViewRefSet<T> | null>(null);\n  if (ref.current === null) {\n    const data: ViewRefSet<T> = {\n      items: new Set(),\n\n      add: (item: T) => {\n        if (data.items.has(item)) return;\n        data.items.add(item);\n      },\n\n      remove: (item: T) => {\n        data.items.delete(item);\n      },\n    };\n    ref.current = data;\n  }\n\n  return ref.current;\n}\n"],"mappings":"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"}