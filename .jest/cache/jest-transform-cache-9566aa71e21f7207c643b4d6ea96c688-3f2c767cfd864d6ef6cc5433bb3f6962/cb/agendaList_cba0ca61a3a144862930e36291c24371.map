{"version":3,"names":["_propTypes","_interopRequireDefault","require","_get","_map","_isFunction","_isUndefined","_debounce","_isEqual","_xdate","_react","_interopRequireWildcard","_reactNative","_hooks","_momentResolver","_dateutils","_interface","_services","_commons","_constants","_style","_Context","_infiniteAgendaList","_jsxRuntime","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty2","getOwnPropertyDescriptors","defineProperties","viewabilityConfig","itemVisiblePercentThreshold","AgendaList","props","_sections$","infiniteListProps","jsx","theme","sections","scrollToNextEvent","_props$viewOffset","viewOffset","avoidDateUpdates","onScroll","onMomentumScrollBegin","onMomentumScrollEnd","onScrollToIndexFailed","renderSectionHeader","sectionStyle","keyExtractor","dayFormatter","_props$dayFormat","dayFormat","useMoment","_props$markToday","markToday","onViewableItemsChanged","_useContext","useContext","Context","date","updateSource","setDate","setDisabled","style","useRef","styleConstructor","list","_topSection","title","didScroll","sectionScroll","sectionHeight","useEffect","current","setTimeout","scrollToSection","useDidUpdate","UpdateSources","LIST_DRAG","CALENDAR_INIT","getSectionIndex","i","map","section","index","getNextSectionIndex","j","_sections","_sections$j","prev","parseDate","next","cur","XDate","isGTE","sameDate","getSectionTitle","useCallback","sectionTitle","moment","getMoment","format","toString","string","getDefaultLocale","today","todayString","isToday","debounce","d","sectionIndex","isUndefined","undefined","_sections$sectionInde","scrollToLocation","animated","itemIndex","viewPosition","constants","isAndroid","leading","trailing","_onViewableItemsChanged","info","viewableItems","topSection","_onScroll","event","cancel","_onMomentumScrollBegin","_onMomentumScrollEnd","headerTextStyle","useMemo","sectionText","_onScrollToIndexFailed","console","log","onHeaderLayout","nativeEvent","layout","height","_renderSectionHeader","_info$section","headerTitle","AgendaSectionHeader","onLayout","_keyExtractor","item","isFunction","String","SectionList","stickySectionHeadersEnabled","ref","showsVerticalScrollIndicator","areTextPropsEqual","isEqual","React","memo","Text","allowFontScaling","children","exports","_default","displayName","propTypes","PropTypes","func","bool","oneOfType","object","number","array"],"sources":["agendaList.js"],"sourcesContent":["import PropTypes from 'prop-types';\nimport get from 'lodash/get';\nimport map from 'lodash/map';\nimport isFunction from 'lodash/isFunction';\nimport isUndefined from 'lodash/isUndefined';\nimport debounce from 'lodash/debounce';\nimport isEqual from 'lodash/isEqual';\nimport XDate from 'xdate';\nimport React, { useCallback, useContext, useEffect, useMemo, useRef } from 'react';\nimport { Text, SectionList } from 'react-native';\nimport { useDidUpdate } from '../hooks';\nimport { getMoment } from '../momentResolver';\nimport { isToday, isGTE, sameDate } from '../dateutils';\nimport { parseDate } from '../interface';\nimport { getDefaultLocale } from '../services';\nimport { UpdateSources, todayString } from './commons';\nimport constants from '../commons/constants';\nimport styleConstructor from './style';\nimport Context from './Context';\nimport InfiniteAgendaList from './infiniteAgendaList';\nconst viewabilityConfig = {\n    itemVisiblePercentThreshold: 20 // 50 means if 50% of the item is visible\n};\n/**\n * @description: AgendaList component\n * @note: Should be wrapped with 'CalendarProvider'\n * @extends: SectionList\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nconst AgendaList = (props) => {\n    if (props.infiniteListProps) {\n        return <InfiniteAgendaList {...props}/>;\n    }\n    const { theme, sections, scrollToNextEvent, viewOffset = 0, avoidDateUpdates, onScroll, onMomentumScrollBegin, onMomentumScrollEnd, onScrollToIndexFailed, renderSectionHeader, sectionStyle, keyExtractor, dayFormatter, dayFormat = 'dddd, MMM d', useMoment, markToday = true, onViewableItemsChanged, } = props;\n    const { date, updateSource, setDate, setDisabled } = useContext(Context);\n    const style = useRef(styleConstructor(theme));\n    const list = useRef();\n    const _topSection = useRef(sections[0]?.title);\n    const didScroll = useRef(false);\n    const sectionScroll = useRef(false);\n    const sectionHeight = useRef(0);\n    useEffect(() => {\n        if (date !== _topSection.current) {\n            setTimeout(() => {\n                scrollToSection(date);\n            }, 500);\n        }\n    }, []);\n    useDidUpdate(() => {\n        // NOTE: on first init data should set first section to the current date!!!\n        if (updateSource !== UpdateSources.LIST_DRAG && updateSource !== UpdateSources.CALENDAR_INIT) {\n            scrollToSection(date);\n        }\n    }, [date]);\n    const getSectionIndex = (date) => {\n        let i;\n        map(sections, (section, index) => {\n            // NOTE: sections titles should match current date format!!!\n            if (section.title === date) {\n                i = index;\n            }\n        });\n        return i;\n    };\n    const getNextSectionIndex = (date) => {\n        let i = 0;\n        for (let j = 1; j < sections.length; j++) {\n            const prev = parseDate(sections[j - 1]?.title);\n            const next = parseDate(sections[j]?.title);\n            const cur = new XDate(date);\n            if (isGTE(cur, prev) && isGTE(next, cur)) {\n                i = sameDate(prev, cur) ? j - 1 : j;\n                break;\n            }\n            else if (isGTE(cur, next)) {\n                i = j;\n            }\n        }\n        return i;\n    };\n    const getSectionTitle = useCallback((title) => {\n        if (!title)\n            return;\n        let sectionTitle = title;\n        if (dayFormatter) {\n            sectionTitle = dayFormatter(title);\n        }\n        else if (dayFormat) {\n            if (useMoment) {\n                const moment = getMoment();\n                sectionTitle = moment(title).format(dayFormat);\n            }\n            else {\n                sectionTitle = new XDate(title).toString(dayFormat);\n            }\n        }\n        if (markToday) {\n            const string = getDefaultLocale().today || todayString;\n            const today = isToday(title);\n            sectionTitle = today ? `${string}, ${sectionTitle}` : sectionTitle;\n        }\n        return sectionTitle;\n    }, []);\n    const scrollToSection = useCallback(debounce((d) => {\n        const sectionIndex = scrollToNextEvent ? getNextSectionIndex(d) : getSectionIndex(d);\n        if (isUndefined(sectionIndex)) {\n            return;\n        }\n        if (list?.current && sectionIndex !== undefined) {\n            sectionScroll.current = true; // to avoid setDate() in onViewableItemsChanged\n            _topSection.current = sections[sectionIndex]?.title;\n            list?.current.scrollToLocation({\n                animated: true,\n                sectionIndex: sectionIndex,\n                itemIndex: 1,\n                viewPosition: 0,\n                viewOffset: (constants.isAndroid ? sectionHeight.current : 0) + viewOffset\n            });\n        }\n    }, 1000, { leading: false, trailing: true }), [viewOffset, sections]);\n    const _onViewableItemsChanged = useCallback((info) => {\n        if (info?.viewableItems && !sectionScroll.current) {\n            const topSection = get(info?.viewableItems[0], 'section.title');\n            if (topSection && topSection !== _topSection.current) {\n                _topSection.current = topSection;\n                if (didScroll.current && !avoidDateUpdates) {\n                    // to avoid setDate() on first load (while setting the initial context.date value)\n                    setDate?.(_topSection.current, UpdateSources.LIST_DRAG);\n                }\n            }\n        }\n        onViewableItemsChanged?.(info);\n    }, [avoidDateUpdates, setDate, onViewableItemsChanged]);\n    const _onScroll = useCallback((event) => {\n        if (!didScroll.current) {\n            didScroll.current = true;\n            scrollToSection.cancel();\n        }\n        onScroll?.(event);\n    }, [onScroll]);\n    const _onMomentumScrollBegin = useCallback((event) => {\n        setDisabled?.(true);\n        onMomentumScrollBegin?.(event);\n    }, [onMomentumScrollBegin, setDisabled]);\n    const _onMomentumScrollEnd = useCallback((event) => {\n        // when list momentum ends AND when scrollToSection scroll ends\n        sectionScroll.current = false;\n        setDisabled?.(false);\n        onMomentumScrollEnd?.(event);\n    }, [onMomentumScrollEnd, setDisabled]);\n    const headerTextStyle = useMemo(() => [style.current.sectionText, sectionStyle], [sectionStyle]);\n    const _onScrollToIndexFailed = useCallback((info) => {\n        if (onScrollToIndexFailed) {\n            onScrollToIndexFailed(info);\n        }\n        else {\n            console.log('onScrollToIndexFailed info: ', info);\n        }\n    }, [onScrollToIndexFailed]);\n    const onHeaderLayout = useCallback((event) => {\n        sectionHeight.current = event.nativeEvent.layout.height;\n    }, []);\n    const _renderSectionHeader = useCallback((info) => {\n        const title = info?.section?.title;\n        if (renderSectionHeader) {\n            return renderSectionHeader(title);\n        }\n        const headerTitle = getSectionTitle(title);\n        return <AgendaSectionHeader title={headerTitle} style={headerTextStyle} onLayout={onHeaderLayout}/>;\n    }, [headerTextStyle]);\n    const _keyExtractor = useCallback((item, index) => {\n        return isFunction(keyExtractor) ? keyExtractor(item, index) : String(index);\n    }, [keyExtractor]);\n    return (<SectionList stickySectionHeadersEnabled {...props} ref={list} keyExtractor={_keyExtractor} showsVerticalScrollIndicator={false} onViewableItemsChanged={_onViewableItemsChanged} viewabilityConfig={viewabilityConfig} renderSectionHeader={_renderSectionHeader} onScroll={_onScroll} onMomentumScrollBegin={_onMomentumScrollBegin} onMomentumScrollEnd={_onMomentumScrollEnd} onScrollToIndexFailed={_onScrollToIndexFailed}/>);\n    // _getItemLayout = (data, index) => {\n    //   return {length: constants.screenWidth, offset: constants.screenWidth * index, index};\n    // }\n};\nfunction areTextPropsEqual(prev, next) {\n    return isEqual(prev.style, next.style) && prev.title === next.title;\n}\nexport const AgendaSectionHeader = React.memo((props) => {\n    return (<Text allowFontScaling={false} style={props.style} onLayout={props.onLayout}>\n      {props.title}\n    </Text>);\n}, areTextPropsEqual);\nexport default AgendaList;\nAgendaList.displayName = 'AgendaList';\nAgendaList.propTypes = {\n    dayFormat: PropTypes.string,\n    dayFormatter: PropTypes.func,\n    useMoment: PropTypes.bool,\n    markToday: PropTypes.bool,\n    sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n    avoidDateUpdates: PropTypes.bool\n};\n"],"mappings":";;;;;;AAAA,IAAAA,UAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,IAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,IAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,WAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,YAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,SAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,QAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,MAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,MAAA,GAAAC,uBAAA,CAAAT,OAAA;AACA,IAAAU,YAAA,GAAAV,OAAA;AACA,IAAAW,MAAA,GAAAX,OAAA;AACA,IAAAY,eAAA,GAAAZ,OAAA;AACA,IAAAa,UAAA,GAAAb,OAAA;AACA,IAAAc,UAAA,GAAAd,OAAA;AACA,IAAAe,SAAA,GAAAf,OAAA;AACA,IAAAgB,QAAA,GAAAhB,OAAA;AACA,IAAAiB,UAAA,GAAAlB,sBAAA,CAAAC,OAAA;AACA,IAAAkB,MAAA,GAAAnB,sBAAA,CAAAC,OAAA;AACA,IAAAmB,QAAA,GAAApB,sBAAA,CAAAC,OAAA;AACA,IAAAoB,mBAAA,GAAArB,sBAAA,CAAAC,OAAA;AAAsD,IAAAqB,WAAA,GAAArB,OAAA;AAAA,SAAAsB,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,yBAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAd,wBAAAkB,GAAA,EAAAJ,WAAA,SAAAA,WAAA,IAAAI,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAG,KAAA,GAAAR,wBAAA,CAAAC,WAAA,OAAAO,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAJ,GAAA,YAAAG,KAAA,CAAAE,GAAA,CAAAL,GAAA,SAAAM,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAX,GAAA,QAAAW,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAd,GAAA,EAAAW,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAV,GAAA,EAAAW,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAX,GAAA,CAAAW,GAAA,SAAAL,MAAA,CAAAJ,OAAA,GAAAF,GAAA,MAAAG,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAAhB,GAAA,EAAAM,MAAA,YAAAA,MAAA;AAAA,SAAAW,QAAAC,CAAA,EAAAC,CAAA,QAAAC,CAAA,GAAAZ,MAAA,CAAAa,IAAA,CAAAH,CAAA,OAAAV,MAAA,CAAAc,qBAAA,QAAAC,CAAA,GAAAf,MAAA,CAAAc,qBAAA,CAAAJ,CAAA,GAAAC,CAAA,KAAAI,CAAA,GAAAA,CAAA,CAAAC,MAAA,WAAAL,CAAA,WAAAX,MAAA,CAAAE,wBAAA,CAAAQ,CAAA,EAAAC,CAAA,EAAAM,UAAA,OAAAL,CAAA,CAAAM,IAAA,CAAAC,KAAA,CAAAP,CAAA,EAAAG,CAAA,YAAAH,CAAA;AAAA,SAAAQ,cAAAV,CAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAU,SAAA,CAAAC,MAAA,EAAAX,CAAA,UAAAC,CAAA,WAAAS,SAAA,CAAAV,CAAA,IAAAU,SAAA,CAAAV,CAAA,QAAAA,CAAA,OAAAF,OAAA,CAAAT,MAAA,CAAAY,CAAA,OAAAW,OAAA,WAAAZ,CAAA,QAAAa,gBAAA,CAAA9B,OAAA,EAAAgB,CAAA,EAAAC,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAX,MAAA,CAAAyB,yBAAA,GAAAzB,MAAA,CAAA0B,gBAAA,CAAAhB,CAAA,EAAAV,MAAA,CAAAyB,yBAAA,CAAAb,CAAA,KAAAH,OAAA,CAAAT,MAAA,CAAAY,CAAA,GAAAW,OAAA,WAAAZ,CAAA,IAAAX,MAAA,CAAAC,cAAA,CAAAS,CAAA,EAAAC,CAAA,EAAAX,MAAA,CAAAE,wBAAA,CAAAU,CAAA,EAAAD,CAAA,iBAAAD,CAAA;AACtD,IAAMiB,iBAAiB,GAAG;EACtBC,2BAA2B,EAAE;AACjC,CAAC;AAOD,IAAMC,UAAU,GAAG,SAAbA,UAAUA,CAAIC,KAAK,EAAK;EAAA,IAAAC,UAAA;EAC1B,IAAID,KAAK,CAACE,iBAAiB,EAAE;IACzB,OAAO,IAAA9C,WAAA,CAAA+C,GAAA,EAAChD,mBAAA,CAAAS,OAAkB,EAAA0B,aAAA,KAAKU,KAAK,CAAE,CAAC;EAC3C;EACA,IAAQI,KAAK,GAAiSJ,KAAK,CAA3SI,KAAK;IAAEC,QAAQ,GAAuRL,KAAK,CAApSK,QAAQ;IAAEC,iBAAiB,GAAoQN,KAAK,CAA1RM,iBAAiB;IAAAC,iBAAA,GAAoQP,KAAK,CAAvQQ,UAAU;IAAVA,UAAU,GAAAD,iBAAA,cAAG,CAAC,GAAAA,iBAAA;IAAEE,gBAAgB,GAAkOT,KAAK,CAAvPS,gBAAgB;IAAEC,QAAQ,GAAwNV,KAAK,CAArOU,QAAQ;IAAEC,qBAAqB,GAAiMX,KAAK,CAA3NW,qBAAqB;IAAEC,mBAAmB,GAA4KZ,KAAK,CAApMY,mBAAmB;IAAEC,qBAAqB,GAAqJb,KAAK,CAA/Ka,qBAAqB;IAAEC,mBAAmB,GAAgId,KAAK,CAAxJc,mBAAmB;IAAEC,YAAY,GAAkHf,KAAK,CAAnIe,YAAY;IAAEC,YAAY,GAAoGhB,KAAK,CAArHgB,YAAY;IAAEC,YAAY,GAAsFjB,KAAK,CAAvGiB,YAAY;IAAAC,gBAAA,GAAsFlB,KAAK,CAAzFmB,SAAS;IAATA,SAAS,GAAAD,gBAAA,cAAG,aAAa,GAAAA,gBAAA;IAAEE,SAAS,GAAgDpB,KAAK,CAA9DoB,SAAS;IAAAC,gBAAA,GAAgDrB,KAAK,CAAnDsB,SAAS;IAATA,SAAS,GAAAD,gBAAA,cAAG,IAAI,GAAAA,gBAAA;IAAEE,sBAAsB,GAAMvB,KAAK,CAAjCuB,sBAAsB;EACxS,IAAAC,WAAA,GAAqD,IAAAC,iBAAU,EAACC,gBAAO,CAAC;IAAhEC,IAAI,GAAAH,WAAA,CAAJG,IAAI;IAAEC,YAAY,GAAAJ,WAAA,CAAZI,YAAY;IAAEC,OAAO,GAAAL,WAAA,CAAPK,OAAO;IAAEC,WAAW,GAAAN,WAAA,CAAXM,WAAW;EAChD,IAAMC,KAAK,GAAG,IAAAC,aAAM,EAAC,IAAAC,cAAgB,EAAC7B,KAAK,CAAC,CAAC;EAC7C,IAAM8B,IAAI,GAAG,IAAAF,aAAM,EAAC,CAAC;EACrB,IAAMG,WAAW,GAAG,IAAAH,aAAM,GAAA/B,UAAA,GAACI,QAAQ,CAAC,CAAC,CAAC,qBAAXJ,UAAA,CAAamC,KAAK,CAAC;EAC9C,IAAMC,SAAS,GAAG,IAAAL,aAAM,EAAC,KAAK,CAAC;EAC/B,IAAMM,aAAa,GAAG,IAAAN,aAAM,EAAC,KAAK,CAAC;EACnC,IAAMO,aAAa,GAAG,IAAAP,aAAM,EAAC,CAAC,CAAC;EAC/B,IAAAQ,gBAAS,EAAC,YAAM;IACZ,IAAIb,IAAI,KAAKQ,WAAW,CAACM,OAAO,EAAE;MAC9BC,UAAU,CAAC,YAAM;QACbC,eAAe,CAAChB,IAAI,CAAC;MACzB,CAAC,EAAE,GAAG,CAAC;IACX;EACJ,CAAC,EAAE,EAAE,CAAC;EACN,IAAAiB,mBAAY,EAAC,YAAM;IAEf,IAAIhB,YAAY,KAAKiB,sBAAa,CAACC,SAAS,IAAIlB,YAAY,KAAKiB,sBAAa,CAACE,aAAa,EAAE;MAC1FJ,eAAe,CAAChB,IAAI,CAAC;IACzB;EACJ,CAAC,EAAE,CAACA,IAAI,CAAC,CAAC;EACV,IAAMqB,eAAe,GAAG,SAAlBA,eAAeA,CAAIrB,IAAI,EAAK;IAC9B,IAAIsB,CAAC;IACL,IAAAC,YAAG,EAAC7C,QAAQ,EAAE,UAAC8C,OAAO,EAAEC,KAAK,EAAK;MAE9B,IAAID,OAAO,CAACf,KAAK,KAAKT,IAAI,EAAE;QACxBsB,CAAC,GAAGG,KAAK;MACb;IACJ,CAAC,CAAC;IACF,OAAOH,CAAC;EACZ,CAAC;EACD,IAAMI,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAI1B,IAAI,EAAK;IAClC,IAAIsB,CAAC,GAAG,CAAC;IACT,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjD,QAAQ,CAACb,MAAM,EAAE8D,CAAC,EAAE,EAAE;MAAA,IAAAC,SAAA,EAAAC,WAAA;MACtC,IAAMC,IAAI,GAAG,IAAAC,oBAAS,GAAAH,SAAA,GAAClD,QAAQ,CAACiD,CAAC,GAAG,CAAC,CAAC,qBAAfC,SAAA,CAAiBnB,KAAK,CAAC;MAC9C,IAAMuB,IAAI,GAAG,IAAAD,oBAAS,GAAAF,WAAA,GAACnD,QAAQ,CAACiD,CAAC,CAAC,qBAAXE,WAAA,CAAapB,KAAK,CAAC;MAC1C,IAAMwB,GAAG,GAAG,IAAIC,cAAK,CAAClC,IAAI,CAAC;MAC3B,IAAI,IAAAmC,gBAAK,EAACF,GAAG,EAAEH,IAAI,CAAC,IAAI,IAAAK,gBAAK,EAACH,IAAI,EAAEC,GAAG,CAAC,EAAE;QACtCX,CAAC,GAAG,IAAAc,mBAAQ,EAACN,IAAI,EAAEG,GAAG,CAAC,GAAGN,CAAC,GAAG,CAAC,GAAGA,CAAC;QACnC;MACJ,CAAC,MACI,IAAI,IAAAQ,gBAAK,EAACF,GAAG,EAAED,IAAI,CAAC,EAAE;QACvBV,CAAC,GAAGK,CAAC;MACT;IACJ;IACA,OAAOL,CAAC;EACZ,CAAC;EACD,IAAMe,eAAe,GAAG,IAAAC,kBAAW,EAAC,UAAC7B,KAAK,EAAK;IAC3C,IAAI,CAACA,KAAK,EACN;IACJ,IAAI8B,YAAY,GAAG9B,KAAK;IACxB,IAAInB,YAAY,EAAE;MACdiD,YAAY,GAAGjD,YAAY,CAACmB,KAAK,CAAC;IACtC,CAAC,MACI,IAAIjB,SAAS,EAAE;MAChB,IAAIC,SAAS,EAAE;QACX,IAAM+C,MAAM,GAAG,IAAAC,yBAAS,EAAC,CAAC;QAC1BF,YAAY,GAAGC,MAAM,CAAC/B,KAAK,CAAC,CAACiC,MAAM,CAAClD,SAAS,CAAC;MAClD,CAAC,MACI;QACD+C,YAAY,GAAG,IAAIL,cAAK,CAACzB,KAAK,CAAC,CAACkC,QAAQ,CAACnD,SAAS,CAAC;MACvD;IACJ;IACA,IAAIG,SAAS,EAAE;MACX,IAAMiD,MAAM,GAAG,IAAAC,0BAAgB,EAAC,CAAC,CAACC,KAAK,IAAIC,oBAAW;MACtD,IAAMD,KAAK,GAAG,IAAAE,kBAAO,EAACvC,KAAK,CAAC;MAC5B8B,YAAY,GAAGO,KAAK,GAAI,GAAEF,MAAO,KAAIL,YAAa,EAAC,GAAGA,YAAY;IACtE;IACA,OAAOA,YAAY;EACvB,CAAC,EAAE,EAAE,CAAC;EACN,IAAMvB,eAAe,GAAG,IAAAsB,kBAAW,EAAC,IAAAW,iBAAQ,EAAC,UAACC,CAAC,EAAK;IAChD,IAAMC,YAAY,GAAGxE,iBAAiB,GAAG+C,mBAAmB,CAACwB,CAAC,CAAC,GAAG7B,eAAe,CAAC6B,CAAC,CAAC;IACpF,IAAI,IAAAE,oBAAW,EAACD,YAAY,CAAC,EAAE;MAC3B;IACJ;IACA,IAAI5C,IAAI,YAAJA,IAAI,CAAEO,OAAO,IAAIqC,YAAY,KAAKE,SAAS,EAAE;MAAA,IAAAC,qBAAA;MAC7C3C,aAAa,CAACG,OAAO,GAAG,IAAI;MAC5BN,WAAW,CAACM,OAAO,IAAAwC,qBAAA,GAAG5E,QAAQ,CAACyE,YAAY,CAAC,qBAAtBG,qBAAA,CAAwB7C,KAAK;MACnDF,IAAI,oBAAJA,IAAI,CAAEO,OAAO,CAACyC,gBAAgB,CAAC;QAC3BC,QAAQ,EAAE,IAAI;QACdL,YAAY,EAAEA,YAAY;QAC1BM,SAAS,EAAE,CAAC;QACZC,YAAY,EAAE,CAAC;QACf7E,UAAU,EAAE,CAAC8E,kBAAS,CAACC,SAAS,GAAGhD,aAAa,CAACE,OAAO,GAAG,CAAC,IAAIjC;MACpE,CAAC,CAAC;IACN;EACJ,CAAC,EAAE,IAAI,EAAE;IAAEgF,OAAO,EAAE,KAAK;IAAEC,QAAQ,EAAE;EAAK,CAAC,CAAC,EAAE,CAACjF,UAAU,EAAEH,QAAQ,CAAC,CAAC;EACrE,IAAMqF,uBAAuB,GAAG,IAAAzB,kBAAW,EAAC,UAAC0B,IAAI,EAAK;IAClD,IAAIA,IAAI,YAAJA,IAAI,CAAEC,aAAa,IAAI,CAACtD,aAAa,CAACG,OAAO,EAAE;MAC/C,IAAMoD,UAAU,GAAG,IAAA9H,YAAG,EAAC4H,IAAI,oBAAJA,IAAI,CAAEC,aAAa,CAAC,CAAC,CAAC,EAAE,eAAe,CAAC;MAC/D,IAAIC,UAAU,IAAIA,UAAU,KAAK1D,WAAW,CAACM,OAAO,EAAE;QAClDN,WAAW,CAACM,OAAO,GAAGoD,UAAU;QAChC,IAAIxD,SAAS,CAACI,OAAO,IAAI,CAAChC,gBAAgB,EAAE;UAExCoB,OAAO,oBAAPA,OAAO,CAAGM,WAAW,CAACM,OAAO,EAAEI,sBAAa,CAACC,SAAS,CAAC;QAC3D;MACJ;IACJ;IACAvB,sBAAsB,oBAAtBA,sBAAsB,CAAGoE,IAAI,CAAC;EAClC,CAAC,EAAE,CAAClF,gBAAgB,EAAEoB,OAAO,EAAEN,sBAAsB,CAAC,CAAC;EACvD,IAAMuE,SAAS,GAAG,IAAA7B,kBAAW,EAAC,UAAC8B,KAAK,EAAK;IACrC,IAAI,CAAC1D,SAAS,CAACI,OAAO,EAAE;MACpBJ,SAAS,CAACI,OAAO,GAAG,IAAI;MACxBE,eAAe,CAACqD,MAAM,CAAC,CAAC;IAC5B;IACAtF,QAAQ,oBAARA,QAAQ,CAAGqF,KAAK,CAAC;EACrB,CAAC,EAAE,CAACrF,QAAQ,CAAC,CAAC;EACd,IAAMuF,sBAAsB,GAAG,IAAAhC,kBAAW,EAAC,UAAC8B,KAAK,EAAK;IAClDjE,WAAW,oBAAXA,WAAW,CAAG,IAAI,CAAC;IACnBnB,qBAAqB,oBAArBA,qBAAqB,CAAGoF,KAAK,CAAC;EAClC,CAAC,EAAE,CAACpF,qBAAqB,EAAEmB,WAAW,CAAC,CAAC;EACxC,IAAMoE,oBAAoB,GAAG,IAAAjC,kBAAW,EAAC,UAAC8B,KAAK,EAAK;IAEhDzD,aAAa,CAACG,OAAO,GAAG,KAAK;IAC7BX,WAAW,oBAAXA,WAAW,CAAG,KAAK,CAAC;IACpBlB,mBAAmB,oBAAnBA,mBAAmB,CAAGmF,KAAK,CAAC;EAChC,CAAC,EAAE,CAACnF,mBAAmB,EAAEkB,WAAW,CAAC,CAAC;EACtC,IAAMqE,eAAe,GAAG,IAAAC,cAAO,EAAC;IAAA,OAAM,CAACrE,KAAK,CAACU,OAAO,CAAC4D,WAAW,EAAEtF,YAAY,CAAC;EAAA,GAAE,CAACA,YAAY,CAAC,CAAC;EAChG,IAAMuF,sBAAsB,GAAG,IAAArC,kBAAW,EAAC,UAAC0B,IAAI,EAAK;IACjD,IAAI9E,qBAAqB,EAAE;MACvBA,qBAAqB,CAAC8E,IAAI,CAAC;IAC/B,CAAC,MACI;MACDY,OAAO,CAACC,GAAG,CAAC,8BAA8B,EAAEb,IAAI,CAAC;IACrD;EACJ,CAAC,EAAE,CAAC9E,qBAAqB,CAAC,CAAC;EAC3B,IAAM4F,cAAc,GAAG,IAAAxC,kBAAW,EAAC,UAAC8B,KAAK,EAAK;IAC1CxD,aAAa,CAACE,OAAO,GAAGsD,KAAK,CAACW,WAAW,CAACC,MAAM,CAACC,MAAM;EAC3D,CAAC,EAAE,EAAE,CAAC;EACN,IAAMC,oBAAoB,GAAG,IAAA5C,kBAAW,EAAC,UAAC0B,IAAI,EAAK;IAAA,IAAAmB,aAAA;IAC/C,IAAM1E,KAAK,GAAGuD,IAAI,qBAAAmB,aAAA,GAAJnB,IAAI,CAAExC,OAAO,qBAAb2D,aAAA,CAAe1E,KAAK;IAClC,IAAItB,mBAAmB,EAAE;MACrB,OAAOA,mBAAmB,CAACsB,KAAK,CAAC;IACrC;IACA,IAAM2E,WAAW,GAAG/C,eAAe,CAAC5B,KAAK,CAAC;IAC1C,OAAO,IAAAhF,WAAA,CAAA+C,GAAA,EAAC6G,mBAAmB;MAAC5E,KAAK,EAAE2E,WAAY;MAAChF,KAAK,EAAEoE,eAAgB;MAACc,QAAQ,EAAER;IAAe,CAAC,CAAC;EACvG,CAAC,EAAE,CAACN,eAAe,CAAC,CAAC;EACrB,IAAMe,aAAa,GAAG,IAAAjD,kBAAW,EAAC,UAACkD,IAAI,EAAE/D,KAAK,EAAK;IAC/C,OAAO,IAAAgE,mBAAU,EAACpG,YAAY,CAAC,GAAGA,YAAY,CAACmG,IAAI,EAAE/D,KAAK,CAAC,GAAGiE,MAAM,CAACjE,KAAK,CAAC;EAC/E,CAAC,EAAE,CAACpC,YAAY,CAAC,CAAC;EAClB,OAAQ,IAAA5D,WAAA,CAAA+C,GAAA,EAAC1D,YAAA,CAAA6K,WAAW,EAAAhI,aAAA,CAAAA,aAAA;IAACiI,2BAA2B;EAAA,GAAKvH,KAAK;IAAEwH,GAAG,EAAEtF,IAAK;IAAClB,YAAY,EAAEkG,aAAc;IAACO,4BAA4B,EAAE,KAAM;IAAClG,sBAAsB,EAAEmE,uBAAwB;IAAC7F,iBAAiB,EAAEA,iBAAkB;IAACiB,mBAAmB,EAAE+F,oBAAqB;IAACnG,QAAQ,EAAEoF,SAAU;IAACnF,qBAAqB,EAAEsF,sBAAuB;IAACrF,mBAAmB,EAAEsF,oBAAqB;IAACrF,qBAAqB,EAAEyF;EAAuB,EAAC,CAAC;AAI9a,CAAC;AACD,SAASoB,iBAAiBA,CAACjE,IAAI,EAAEE,IAAI,EAAE;EACnC,OAAO,IAAAgE,gBAAO,EAAClE,IAAI,CAAC1B,KAAK,EAAE4B,IAAI,CAAC5B,KAAK,CAAC,IAAI0B,IAAI,CAACrB,KAAK,KAAKuB,IAAI,CAACvB,KAAK;AACvE;AACO,IAAM4E,mBAAmB,GAAGY,cAAK,CAACC,IAAI,CAAC,UAAC7H,KAAK,EAAK;EACrD,OAAQ,IAAA5C,WAAA,CAAA+C,GAAA,EAAC1D,YAAA,CAAAqL,IAAI;IAACC,gBAAgB,EAAE,KAAM;IAAChG,KAAK,EAAE/B,KAAK,CAAC+B,KAAM;IAACkF,QAAQ,EAAEjH,KAAK,CAACiH,QAAS;IAAAe,QAAA,EACjFhI,KAAK,CAACoC;EAAK,CACR,CAAC;AACX,CAAC,EAAEsF,iBAAiB,CAAC;AAACO,OAAA,CAAAjB,mBAAA,GAAAA,mBAAA;AAAA,IAAAkB,QAAA,GACPnI,UAAU;AAAAkI,OAAA,CAAArK,OAAA,GAAAsK,QAAA;AACzBnI,UAAU,CAACoI,WAAW,GAAG,YAAY;AACrCpI,UAAU,CAACqI,SAAS,GAAG;EACnBjH,SAAS,EAAEkH,kBAAS,CAAC9D,MAAM;EAC3BtD,YAAY,EAAEoH,kBAAS,CAACC,IAAI;EAC5BlH,SAAS,EAAEiH,kBAAS,CAACE,IAAI;EACzBjH,SAAS,EAAE+G,kBAAS,CAACE,IAAI;EACzBxH,YAAY,EAAEsH,kBAAS,CAACG,SAAS,CAAC,CAACH,kBAAS,CAACI,MAAM,EAAEJ,kBAAS,CAACK,MAAM,EAAEL,kBAAS,CAACM,KAAK,CAAC,CAAC;EACxFlI,gBAAgB,EAAE4H,kBAAS,CAACE;AAChC,CAAC"}