{"version":3,"names":["_Colors","require","_NativeReanimated","_interopRequireDefault","IN_STYLE_UPDATER","initialUpdaterRun","updater","result","_worklet_14452725944424_init_data","code","location","sourceMap","recognizePrefixSuffix","_e","global","Error","_f","value","_match$","match","prefix","suffix","number","strippedValue","parseFloat","_closure","__initData","__workletHash","__stackDetails","__version","_worklet_7675676752948_init_data","decorateAnimation","animation","isHigherOrder","baseOnStart","onStart","baseOnFrame","onFrame","animationCopy","Object","assign","callback","prefNumberSuffOnStart","timestamp","previousAnimation","_animation$__prefix","_animation$__suffix","_recognizePrefixSuffi","__prefix","__suffix","strippedCurrent","_recognizePrefixSuffi2","toValue","strippedToValue","current","startValue","_recognizePrefixSuffi3","paPrefix","paSuffix","paStrippedValue","_previousAnimation$__","_previousAnimation$__2","prefNumberSuffOnFrame","_animation$__prefix2","_animation$__suffix2","res","tab","colorOnStart","RGBAValue","RGBACurrent","RGBAToValue","isColor","toLinearSpace","convertToRGBA","forEach","i","index","undefined","push","rgbaArrayToRGBAColor","toGammaSpace","colorOnFrame","finished","arrayOnStart","v","arrayOnFrame","objectOnStart","key","objectOnFrame","newObject","Array","isArray","IS_NATIVE","NativeReanimatedModule","native","_worklet_9563541438710_init_data","_worklet_17288123765057_init_data","defineAnimation","starting","factory","create","_WORKLET","exports","_worklet_6149673277334_init_data","cancelAnimation","sharedValue","_worklet_8645392350280_init_data","_worklet_9761411289677_init_data","withStartValue"],"sources":["util.ts"],"sourcesContent":["import {\n  HigherOrderAnimation,\n  NextAnimation,\n  DelayAnimation,\n  RepeatAnimation,\n  SequenceAnimation,\n  StyleLayoutAnimation,\n} from './commonTypes';\n/* global _WORKLET */\nimport {\n  ParsedColorArray,\n  isColor,\n  convertToRGBA,\n  rgbaArrayToRGBAColor,\n  toGammaSpace,\n  toLinearSpace,\n} from '../Colors';\n\nimport {\n  AnimatedStyle,\n  SharedValue,\n  AnimatableValue,\n  Animation,\n  AnimationObject,\n  Timestamp,\n  AnimatableValueObject,\n} from '../commonTypes';\nimport NativeReanimatedModule from '../NativeReanimated';\n\nlet IN_STYLE_UPDATER = false;\n\nexport type UserUpdater = () => AnimatedStyle;\n\nexport function initialUpdaterRun<T>(updater: () => T): T {\n  IN_STYLE_UPDATER = true;\n  const result = updater();\n  IN_STYLE_UPDATER = false;\n  return result;\n}\n\ninterface RecognizedPrefixSuffix {\n  prefix?: string;\n  suffix?: string;\n  strippedValue: number;\n}\n\nfunction recognizePrefixSuffix(value: string | number): RecognizedPrefixSuffix {\n  'worklet';\n  if (typeof value === 'string') {\n    const match = value.match(\n      /([A-Za-z]*)(-?\\d*\\.?\\d*)([eE][-+]?[0-9]+)?([A-Za-z%]*)/\n    );\n    if (!match) {\n      throw Error(\n        \"Couldn't parse animation value. Check if there isn't any typo.\"\n      );\n    }\n    const prefix = match[1];\n    const suffix = match[4];\n    // number with scientific notation\n    const number = match[2] + (match[3] ?? '');\n    return { prefix, suffix, strippedValue: parseFloat(number) };\n  } else {\n    return { strippedValue: value };\n  }\n}\n\nfunction decorateAnimation<T extends AnimationObject | StyleLayoutAnimation>(\n  animation: T\n): void {\n  'worklet';\n  if ((animation as HigherOrderAnimation).isHigherOrder) {\n    return;\n  }\n\n  const baseOnStart = (animation as Animation<AnimationObject>).onStart;\n  const baseOnFrame = (animation as Animation<AnimationObject>).onFrame;\n  const animationCopy = Object.assign({}, animation);\n  delete animationCopy.callback;\n\n  const prefNumberSuffOnStart = (\n    animation: Animation<AnimationObject>,\n    value: string | number,\n    timestamp: number,\n    previousAnimation: Animation<AnimationObject>\n  ) => {\n    // recognize prefix, suffix, and updates stripped value on animation start\n    const { prefix, suffix, strippedValue } = recognizePrefixSuffix(value);\n    animation.__prefix = prefix;\n    animation.__suffix = suffix;\n    animation.strippedCurrent = strippedValue;\n    const { strippedValue: strippedToValue } = recognizePrefixSuffix(\n      animation.toValue as string | number\n    );\n    animation.current = strippedValue;\n    animation.startValue = strippedValue;\n    animation.toValue = strippedToValue;\n    if (previousAnimation && previousAnimation !== animation) {\n      const {\n        prefix: paPrefix,\n        suffix: paSuffix,\n        strippedValue: paStrippedValue,\n      } = recognizePrefixSuffix(previousAnimation.current as string | number);\n      previousAnimation.current = paStrippedValue;\n      previousAnimation.__prefix = paPrefix;\n      previousAnimation.__suffix = paSuffix;\n    }\n\n    baseOnStart(animation, strippedValue, timestamp, previousAnimation);\n\n    animation.current =\n      (animation.__prefix ?? '') +\n      animation.current +\n      (animation.__suffix ?? '');\n\n    if (previousAnimation && previousAnimation !== animation) {\n      previousAnimation.current =\n        (previousAnimation.__prefix ?? '') +\n        previousAnimation.current +\n        (previousAnimation.__suffix ?? '');\n    }\n  };\n  const prefNumberSuffOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: number\n  ) => {\n    animation.current = animation.strippedCurrent;\n    const res = baseOnFrame(animation, timestamp);\n    animation.strippedCurrent = animation.current;\n    animation.current =\n      (animation.__prefix ?? '') +\n      animation.current +\n      (animation.__suffix ?? '');\n    return res;\n  };\n\n  const tab = ['R', 'G', 'B', 'A'];\n  const colorOnStart = (\n    animation: Animation<AnimationObject>,\n    value: string | number,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ): void => {\n    let RGBAValue: ParsedColorArray;\n    let RGBACurrent: ParsedColorArray;\n    let RGBAToValue: ParsedColorArray;\n    const res: Array<number> = [];\n    if (isColor(value)) {\n      RGBACurrent = toLinearSpace(convertToRGBA(animation.current));\n      RGBAValue = toLinearSpace(convertToRGBA(value));\n      if (animation.toValue) {\n        RGBAToValue = toLinearSpace(convertToRGBA(animation.toValue));\n      }\n    }\n    tab.forEach((i, index) => {\n      animation[i] = Object.assign({}, animationCopy);\n      animation[i].current = RGBACurrent[index];\n      animation[i].toValue = RGBAToValue ? RGBAToValue[index] : undefined;\n      animation[i].onStart(\n        animation[i],\n        RGBAValue[index],\n        timestamp,\n        previousAnimation ? previousAnimation[i] : undefined\n      );\n      res.push(animation[i].current);\n    });\n\n    animation.current = rgbaArrayToRGBAColor(\n      toGammaSpace(res as ParsedColorArray)\n    );\n  };\n\n  const colorOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: Timestamp\n  ): boolean => {\n    const RGBACurrent = toLinearSpace(convertToRGBA(animation.current));\n    const res: Array<number> = [];\n    let finished = true;\n    tab.forEach((i, index) => {\n      animation[i].current = RGBACurrent[index];\n      // @ts-ignore: disable-next-line\n      finished &= animation[i].onFrame(animation[i], timestamp);\n      res.push(animation[i].current);\n    });\n\n    animation.current = rgbaArrayToRGBAColor(\n      toGammaSpace(res as ParsedColorArray)\n    );\n    return finished;\n  };\n\n  const arrayOnStart = (\n    animation: Animation<AnimationObject>,\n    value: Array<number>,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ): void => {\n    value.forEach((v, i) => {\n      animation[i] = Object.assign({}, animationCopy);\n      animation[i].current = v;\n      animation[i].toValue = (animation.toValue as Array<number>)[i];\n      animation[i].onStart(\n        animation[i],\n        v,\n        timestamp,\n        previousAnimation ? previousAnimation[i] : undefined\n      );\n    });\n\n    animation.current = value;\n  };\n\n  const arrayOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: Timestamp\n  ): boolean => {\n    let finished = true;\n    (animation.current as Array<number>).forEach((v, i) => {\n      // @ts-ignore: disable-next-line\n      finished &= animation[i].onFrame(animation[i], timestamp);\n      (animation.current as Array<number>)[i] = animation[i].current;\n    });\n\n    return finished;\n  };\n\n  const objectOnStart = (\n    animation: Animation<AnimationObject>,\n    value: AnimatableValueObject,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ): void => {\n    for (const key in value) {\n      animation[key] = Object.assign({}, animationCopy);\n      animation[key].onStart = animation.onStart;\n\n      animation[key].current = value[key];\n      animation[key].toValue = (animation.toValue as AnimatableValueObject)[\n        key\n      ];\n      animation[key].onStart(\n        animation[key],\n        value[key],\n        timestamp,\n        previousAnimation ? previousAnimation[key] : undefined\n      );\n    }\n    animation.current = value;\n  };\n\n  const objectOnFrame = (\n    animation: Animation<AnimationObject>,\n    timestamp: Timestamp\n  ): boolean => {\n    let finished = true;\n    const newObject: AnimatableValueObject = {};\n    for (const key in animation.current as AnimatableValueObject) {\n      // @ts-ignore: disable-next-line\n      finished &= animation[key].onFrame(animation[key], timestamp);\n      newObject[key] = animation[key].current;\n    }\n    animation.current = newObject;\n    return finished;\n  };\n\n  animation.onStart = (\n    animation: Animation<AnimationObject>,\n    value: number,\n    timestamp: Timestamp,\n    previousAnimation: Animation<AnimationObject>\n  ) => {\n    if (isColor(value)) {\n      colorOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = colorOnFrame;\n      return;\n    } else if (Array.isArray(value)) {\n      arrayOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = arrayOnFrame;\n      return;\n    } else if (typeof value === 'string') {\n      prefNumberSuffOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = prefNumberSuffOnFrame;\n      return;\n    } else if (typeof value === 'object' && value !== null) {\n      objectOnStart(animation, value, timestamp, previousAnimation);\n      animation.onFrame = objectOnFrame;\n      return;\n    }\n    baseOnStart(animation, value, timestamp, previousAnimation);\n  };\n}\n\ntype AnimationToDecoration<T extends AnimationObject | StyleLayoutAnimation> =\n  T extends StyleLayoutAnimation\n    ? Record<string, unknown>\n    : T extends DelayAnimation\n    ? NextAnimation<DelayAnimation>\n    : T extends RepeatAnimation\n    ? NextAnimation<RepeatAnimation>\n    : T extends SequenceAnimation\n    ? NextAnimation<SequenceAnimation>\n    : AnimatableValue | T;\n\nconst IS_NATIVE = NativeReanimatedModule.native;\n\nexport function defineAnimation<\n  T extends AnimationObject | StyleLayoutAnimation\n>(starting: AnimationToDecoration<T>, factory: () => T): T {\n  'worklet';\n  if (IN_STYLE_UPDATER) {\n    return starting as T;\n  }\n  const create = () => {\n    'worklet';\n    const animation = factory();\n    decorateAnimation<T>(animation);\n    return animation;\n  };\n\n  if (_WORKLET || !IS_NATIVE) {\n    return create();\n  }\n  // @ts-ignore: eslint-disable-line\n  return create;\n}\n\nexport function cancelAnimation<T>(sharedValue: SharedValue<T>): void {\n  'worklet';\n  // setting the current value cancels the animation if one is currently running\n  sharedValue.value = sharedValue.value; // eslint-disable-line no-self-assign\n}\n\n// TODO it should work only if there was no animation before.\nexport function withStartValue(\n  startValue: AnimatableValue,\n  animation: NextAnimation<AnimationObject>\n): Animation<AnimationObject> {\n  'worklet';\n  return defineAnimation(startValue, () => {\n    'worklet';\n    if (!_WORKLET && typeof animation === 'function') {\n      animation = animation();\n    }\n    (animation as Animation<AnimationObject>).current = startValue;\n    return animation as Animation<AnimationObject>;\n  });\n}\n"],"mappings":"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"}