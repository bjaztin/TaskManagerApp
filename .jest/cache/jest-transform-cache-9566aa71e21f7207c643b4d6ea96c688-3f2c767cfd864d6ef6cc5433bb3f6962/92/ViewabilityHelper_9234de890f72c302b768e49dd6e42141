ff33c02866bfe3437dbcbb112d8acac6
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
var invariant = require('invariant');
var ViewabilityHelper = function () {
  function ViewabilityHelper() {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      viewAreaCoveragePercentThreshold: 0
    };
    (0, _classCallCheck2.default)(this, ViewabilityHelper);
    this._hasInteracted = false;
    this._timers = new Set();
    this._viewableIndices = [];
    this._viewableItems = new Map();
    this._config = config;
  }
  (0, _createClass2.default)(ViewabilityHelper, [{
    key: "dispose",
    value: function dispose() {
      this._timers.forEach(clearTimeout);
    }
  }, {
    key: "computeViewableItems",
    value: function computeViewableItems(props, scrollOffset, viewportHeight, getFrameMetrics, renderRange) {
      var itemCount = props.getItemCount(props.data);
      var _this$_config = this._config,
        itemVisiblePercentThreshold = _this$_config.itemVisiblePercentThreshold,
        viewAreaCoveragePercentThreshold = _this$_config.viewAreaCoveragePercentThreshold;
      var viewAreaMode = viewAreaCoveragePercentThreshold != null;
      var viewablePercentThreshold = viewAreaMode ? viewAreaCoveragePercentThreshold : itemVisiblePercentThreshold;
      invariant(viewablePercentThreshold != null && itemVisiblePercentThreshold != null !== (viewAreaCoveragePercentThreshold != null), 'Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold');
      var viewableIndices = [];
      if (itemCount === 0) {
        return viewableIndices;
      }
      var firstVisible = -1;
      var _ref = renderRange || {
          first: 0,
          last: itemCount - 1
        },
        first = _ref.first,
        last = _ref.last;
      if (last >= itemCount) {
        console.warn('Invalid render range computing viewability ' + JSON.stringify({
          renderRange: renderRange,
          itemCount: itemCount
        }));
        return [];
      }
      for (var idx = first; idx <= last; idx++) {
        var metrics = getFrameMetrics(idx, props);
        if (!metrics) {
          continue;
        }
        var top = metrics.offset - scrollOffset;
        var bottom = top + metrics.length;
        if (top < viewportHeight && bottom > 0) {
          firstVisible = idx;
          if (_isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, metrics.length)) {
            viewableIndices.push(idx);
          }
        } else if (firstVisible >= 0) {
          break;
        }
      }
      return viewableIndices;
    }
  }, {
    key: "onUpdate",
    value: function onUpdate(props, scrollOffset, viewportHeight, getFrameMetrics, createViewToken, onViewableItemsChanged, renderRange) {
      var _this = this;
      var itemCount = props.getItemCount(props.data);
      if (this._config.waitForInteraction && !this._hasInteracted || itemCount === 0 || !getFrameMetrics(0, props)) {
        return;
      }
      var viewableIndices = [];
      if (itemCount) {
        viewableIndices = this.computeViewableItems(props, scrollOffset, viewportHeight, getFrameMetrics, renderRange);
      }
      if (this._viewableIndices.length === viewableIndices.length && this._viewableIndices.every(function (v, ii) {
        return v === viewableIndices[ii];
      })) {
        return;
      }
      this._viewableIndices = viewableIndices;
      if (this._config.minimumViewTime) {
        var handle = setTimeout(function () {
          _this._timers.delete(handle);
          _this._onUpdateSync(props, viewableIndices, onViewableItemsChanged, createViewToken);
        }, this._config.minimumViewTime);
        this._timers.add(handle);
      } else {
        this._onUpdateSync(props, viewableIndices, onViewableItemsChanged, createViewToken);
      }
    }
  }, {
    key: "resetViewableIndices",
    value: function resetViewableIndices() {
      this._viewableIndices = [];
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      this._hasInteracted = true;
    }
  }, {
    key: "_onUpdateSync",
    value: function _onUpdateSync(props, viewableIndicesToCheck, onViewableItemsChanged, createViewToken) {
      var _this2 = this;
      viewableIndicesToCheck = viewableIndicesToCheck.filter(function (ii) {
        return _this2._viewableIndices.includes(ii);
      });
      var prevItems = this._viewableItems;
      var nextItems = new Map(viewableIndicesToCheck.map(function (ii) {
        var viewable = createViewToken(ii, true, props);
        return [viewable.key, viewable];
      }));
      var changed = [];
      for (var _ref2 of nextItems) {
        var _ref3 = (0, _slicedToArray2.default)(_ref2, 2);
        var key = _ref3[0];
        var viewable = _ref3[1];
        if (!prevItems.has(key)) {
          changed.push(viewable);
        }
      }
      for (var _ref4 of prevItems) {
        var _ref5 = (0, _slicedToArray2.default)(_ref4, 2);
        var _key = _ref5[0];
        var _viewable = _ref5[1];
        if (!nextItems.has(_key)) {
          changed.push(_objectSpread(_objectSpread({}, _viewable), {}, {
            isViewable: false
          }));
        }
      }
      if (changed.length > 0) {
        this._viewableItems = nextItems;
        onViewableItemsChanged({
          viewableItems: Array.from(nextItems.values()),
          changed: changed,
          viewabilityConfig: this._config
        });
      }
    }
  }]);
  return ViewabilityHelper;
}();
function _isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, itemLength) {
  if (_isEntirelyVisible(top, bottom, viewportHeight)) {
    return true;
  } else {
    var pixels = _getPixelsVisible(top, bottom, viewportHeight);
    var percent = 100 * (viewAreaMode ? pixels / viewportHeight : pixels / itemLength);
    return percent >= viewablePercentThreshold;
  }
}
function _getPixelsVisible(top, bottom, viewportHeight) {
  var visibleHeight = Math.min(bottom, viewportHeight) - Math.max(top, 0);
  return Math.max(0, visibleHeight);
}
function _isEntirelyVisible(top, bottom, viewportHeight) {
  return top >= 0 && bottom <= viewportHeight && bottom > top;
}
module.exports = ViewabilityHelper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJfc2xpY2VkVG9BcnJheTIiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2NyZWF0ZUNsYXNzMiIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsImRlZmF1bHQiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5IiwiaW52YXJpYW50IiwiVmlld2FiaWxpdHlIZWxwZXIiLCJjb25maWciLCJ1bmRlZmluZWQiLCJ2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCIsIl9oYXNJbnRlcmFjdGVkIiwiX3RpbWVycyIsIlNldCIsIl92aWV3YWJsZUluZGljZXMiLCJfdmlld2FibGVJdGVtcyIsIk1hcCIsIl9jb25maWciLCJrZXkiLCJ2YWx1ZSIsImRpc3Bvc2UiLCJjbGVhclRpbWVvdXQiLCJjb21wdXRlVmlld2FibGVJdGVtcyIsInByb3BzIiwic2Nyb2xsT2Zmc2V0Iiwidmlld3BvcnRIZWlnaHQiLCJnZXRGcmFtZU1ldHJpY3MiLCJyZW5kZXJSYW5nZSIsIml0ZW1Db3VudCIsImdldEl0ZW1Db3VudCIsImRhdGEiLCJfdGhpcyRfY29uZmlnIiwiaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkIiwidmlld0FyZWFNb2RlIiwidmlld2FibGVQZXJjZW50VGhyZXNob2xkIiwidmlld2FibGVJbmRpY2VzIiwiZmlyc3RWaXNpYmxlIiwiX3JlZiIsImZpcnN0IiwibGFzdCIsImNvbnNvbGUiLCJ3YXJuIiwiSlNPTiIsInN0cmluZ2lmeSIsImlkeCIsIm1ldHJpY3MiLCJ0b3AiLCJvZmZzZXQiLCJib3R0b20iLCJfaXNWaWV3YWJsZSIsIm9uVXBkYXRlIiwiY3JlYXRlVmlld1Rva2VuIiwib25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCIsIl90aGlzIiwid2FpdEZvckludGVyYWN0aW9uIiwiZXZlcnkiLCJ2IiwiaWkiLCJtaW5pbXVtVmlld1RpbWUiLCJoYW5kbGUiLCJzZXRUaW1lb3V0IiwiZGVsZXRlIiwiX29uVXBkYXRlU3luYyIsImFkZCIsInJlc2V0Vmlld2FibGVJbmRpY2VzIiwicmVjb3JkSW50ZXJhY3Rpb24iLCJ2aWV3YWJsZUluZGljZXNUb0NoZWNrIiwiX3RoaXMyIiwiaW5jbHVkZXMiLCJwcmV2SXRlbXMiLCJuZXh0SXRlbXMiLCJtYXAiLCJ2aWV3YWJsZSIsImNoYW5nZWQiLCJfcmVmMiIsIl9yZWYzIiwiaGFzIiwiX3JlZjQiLCJfcmVmNSIsImlzVmlld2FibGUiLCJ2aWV3YWJsZUl0ZW1zIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwidmlld2FiaWxpdHlDb25maWciLCJpdGVtTGVuZ3RoIiwiX2lzRW50aXJlbHlWaXNpYmxlIiwicGl4ZWxzIiwiX2dldFBpeGVsc1Zpc2libGUiLCJwZXJjZW50IiwidmlzaWJsZUhlaWdodCIsIk1hdGgiLCJtaW4iLCJtYXgiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiVmlld2FiaWxpdHlIZWxwZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE1ldGEgUGxhdGZvcm1zLCBJbmMuIGFuZCBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgdHlwZSB7RnJhbWVNZXRyaWNQcm9wc30gZnJvbSAnLi9WaXJ0dWFsaXplZExpc3RQcm9wcyc7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xuXG5leHBvcnQgdHlwZSBWaWV3VG9rZW4gPSB7XG4gIGl0ZW06IGFueSxcbiAga2V5OiBzdHJpbmcsXG4gIGluZGV4OiA/bnVtYmVyLFxuICBpc1ZpZXdhYmxlOiBib29sZWFuLFxuICBzZWN0aW9uPzogYW55LFxuICAuLi5cbn07XG5cbmV4cG9ydCB0eXBlIFZpZXdhYmlsaXR5Q29uZmlnQ2FsbGJhY2tQYWlyID0ge1xuICB2aWV3YWJpbGl0eUNvbmZpZzogVmlld2FiaWxpdHlDb25maWcsXG4gIG9uVmlld2FibGVJdGVtc0NoYW5nZWQ6IChpbmZvOiB7XG4gICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgIC4uLlxuICB9KSA9PiB2b2lkLFxuICAuLi5cbn07XG5cbmV4cG9ydCB0eXBlIFZpZXdhYmlsaXR5Q29uZmlnID0ge3xcbiAgLyoqXG4gICAqIE1pbmltdW0gYW1vdW50IG9mIHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdGhhdCBhbiBpdGVtIG11c3QgYmUgcGh5c2ljYWxseSB2aWV3YWJsZSBiZWZvcmUgdGhlXG4gICAqIHZpZXdhYmlsaXR5IGNhbGxiYWNrIHdpbGwgYmUgZmlyZWQuIEEgaGlnaCBudW1iZXIgbWVhbnMgdGhhdCBzY3JvbGxpbmcgdGhyb3VnaCBjb250ZW50IHdpdGhvdXRcbiAgICogc3RvcHBpbmcgd2lsbCBub3QgbWFyayB0aGUgY29udGVudCBhcyB2aWV3YWJsZS5cbiAgICovXG4gIG1pbmltdW1WaWV3VGltZT86IG51bWJlcixcblxuICAvKipcbiAgICogUGVyY2VudCBvZiB2aWV3cG9ydCB0aGF0IG11c3QgYmUgY292ZXJlZCBmb3IgYSBwYXJ0aWFsbHkgb2NjbHVkZWQgaXRlbSB0byBjb3VudCBhc1xuICAgKiBcInZpZXdhYmxlXCIsIDAtMTAwLiBGdWxseSB2aXNpYmxlIGl0ZW1zIGFyZSBhbHdheXMgY29uc2lkZXJlZCB2aWV3YWJsZS4gQSB2YWx1ZSBvZiAwIG1lYW5zXG4gICAqIHRoYXQgYSBzaW5nbGUgcGl4ZWwgaW4gdGhlIHZpZXdwb3J0IG1ha2VzIHRoZSBpdGVtIHZpZXdhYmxlLCBhbmQgYSB2YWx1ZSBvZiAxMDAgbWVhbnMgdGhhdFxuICAgKiBhbiBpdGVtIG11c3QgYmUgZWl0aGVyIGVudGlyZWx5IHZpc2libGUgb3IgY292ZXIgdGhlIGVudGlyZSB2aWV3cG9ydCB0byBjb3VudCBhcyB2aWV3YWJsZS5cbiAgICovXG4gIHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkPzogbnVtYmVyLFxuXG4gIC8qKlxuICAgKiBTaW1pbGFyIHRvIGB2aWV3QXJlYVBlcmNlbnRUaHJlc2hvbGRgLCBidXQgY29uc2lkZXJzIHRoZSBwZXJjZW50IG9mIHRoZSBpdGVtIHRoYXQgaXMgdmlzaWJsZSxcbiAgICogcmF0aGVyIHRoYW4gdGhlIGZyYWN0aW9uIG9mIHRoZSB2aWV3YWJsZSBhcmVhIGl0IGNvdmVycy5cbiAgICovXG4gIGl0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZD86IG51bWJlcixcblxuICAvKipcbiAgICogTm90aGluZyBpcyBjb25zaWRlcmVkIHZpZXdhYmxlIHVudGlsIHRoZSB1c2VyIHNjcm9sbHMgb3IgYHJlY29yZEludGVyYWN0aW9uYCBpcyBjYWxsZWQgYWZ0ZXJcbiAgICogcmVuZGVyLlxuICAgKi9cbiAgd2FpdEZvckludGVyYWN0aW9uPzogYm9vbGVhbixcbnx9O1xuXG4vKipcbiAqIEEgVXRpbGl0eSBjbGFzcyBmb3IgY2FsY3VsYXRpbmcgdmlld2FibGUgaXRlbXMgYmFzZWQgb24gY3VycmVudCBtZXRyaWNzIGxpa2Ugc2Nyb2xsIHBvc2l0aW9uIGFuZFxuICogbGF5b3V0LlxuICpcbiAqIEFuIGl0ZW0gaXMgc2FpZCB0byBiZSBpbiBhIFwidmlld2FibGVcIiBzdGF0ZSB3aGVuIGFueSBvZiB0aGUgZm9sbG93aW5nXG4gKiBpcyB0cnVlIGZvciBsb25nZXIgdGhhbiBgbWluaW11bVZpZXdUaW1lYCBtaWxsaXNlY29uZHMgKGFmdGVyIGFuIGludGVyYWN0aW9uIGlmIGB3YWl0Rm9ySW50ZXJhY3Rpb25gXG4gKiBpcyB0cnVlKTpcbiAqXG4gKiAtIE9jY3VweWluZyA+PSBgdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGRgIG9mIHRoZSB2aWV3IGFyZWEgWE9SIGZyYWN0aW9uIG9mIHRoZSBpdGVtXG4gKiAgIHZpc2libGUgaW4gdGhlIHZpZXcgYXJlYSA+PSBgaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkYC5cbiAqIC0gRW50aXJlbHkgdmlzaWJsZSBvbiBzY3JlZW5cbiAqL1xuY2xhc3MgVmlld2FiaWxpdHlIZWxwZXIge1xuICBfY29uZmlnOiBWaWV3YWJpbGl0eUNvbmZpZztcbiAgX2hhc0ludGVyYWN0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgX3RpbWVyczogU2V0PG51bWJlcj4gPSBuZXcgU2V0KCk7XG4gIF92aWV3YWJsZUluZGljZXM6IEFycmF5PG51bWJlcj4gPSBbXTtcbiAgX3ZpZXdhYmxlSXRlbXM6IE1hcDxzdHJpbmcsIFZpZXdUb2tlbj4gPSBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgY29uZmlnOiBWaWV3YWJpbGl0eUNvbmZpZyA9IHt2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZDogMH0sXG4gICkge1xuICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwLCBlLmcuIG9uIHVubW91bnQuIENsZWFycyBhbnkgcGVuZGluZyB0aW1lcnMuXG4gICAqL1xuICBkaXNwb3NlKCkge1xuICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUbyBzZWVcbiAgICAgKiB0aGUgZXJyb3IgZGVsZXRlIHRoaXMgY29tbWVudCBhbmQgcnVuIEZsb3cuICovXG4gICAgdGhpcy5fdGltZXJzLmZvckVhY2goY2xlYXJUaW1lb3V0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIHdoaWNoIGl0ZW1zIGFyZSB2aWV3YWJsZSBiYXNlZCBvbiB0aGUgY3VycmVudCBtZXRyaWNzIGFuZCBjb25maWcuXG4gICAqL1xuICBjb21wdXRlVmlld2FibGVJdGVtcyhcbiAgICBwcm9wczogRnJhbWVNZXRyaWNQcm9wcyxcbiAgICBzY3JvbGxPZmZzZXQ6IG51bWJlcixcbiAgICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuICAgIGdldEZyYW1lTWV0cmljczogKFxuICAgICAgaW5kZXg6IG51bWJlcixcbiAgICAgIHByb3BzOiBGcmFtZU1ldHJpY1Byb3BzLFxuICAgICkgPT4gP3tcbiAgICAgIGxlbmd0aDogbnVtYmVyLFxuICAgICAgb2Zmc2V0OiBudW1iZXIsXG4gICAgICAuLi5cbiAgICB9LFxuICAgIC8vIE9wdGlvbmFsIG9wdGltaXphdGlvbiB0byByZWR1Y2UgdGhlIHNjYW4gc2l6ZVxuICAgIHJlbmRlclJhbmdlPzoge1xuICAgICAgZmlyc3Q6IG51bWJlcixcbiAgICAgIGxhc3Q6IG51bWJlcixcbiAgICAgIC4uLlxuICAgIH0sXG4gICk6IEFycmF5PG51bWJlcj4ge1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHByb3BzLmdldEl0ZW1Db3VudChwcm9wcy5kYXRhKTtcbiAgICBjb25zdCB7aXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkLCB2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZH0gPVxuICAgICAgdGhpcy5fY29uZmlnO1xuICAgIGNvbnN0IHZpZXdBcmVhTW9kZSA9IHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkICE9IG51bGw7XG4gICAgY29uc3Qgdmlld2FibGVQZXJjZW50VGhyZXNob2xkID0gdmlld0FyZWFNb2RlXG4gICAgICA/IHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkXG4gICAgICA6IGl0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZDtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQgIT0gbnVsbCAmJlxuICAgICAgICAoaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkICE9IG51bGwpICE9PVxuICAgICAgICAgICh2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCAhPSBudWxsKSxcbiAgICAgICdNdXN0IHNldCBleGFjdGx5IG9uZSBvZiBpdGVtVmlzaWJsZVBlcmNlbnRUaHJlc2hvbGQgb3Igdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGQnLFxuICAgICk7XG4gICAgY29uc3Qgdmlld2FibGVJbmRpY2VzID0gW107XG4gICAgaWYgKGl0ZW1Db3VudCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHZpZXdhYmxlSW5kaWNlcztcbiAgICB9XG4gICAgbGV0IGZpcnN0VmlzaWJsZSA9IC0xO1xuICAgIGNvbnN0IHtmaXJzdCwgbGFzdH0gPSByZW5kZXJSYW5nZSB8fCB7Zmlyc3Q6IDAsIGxhc3Q6IGl0ZW1Db3VudCAtIDF9O1xuICAgIGlmIChsYXN0ID49IGl0ZW1Db3VudCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnSW52YWxpZCByZW5kZXIgcmFuZ2UgY29tcHV0aW5nIHZpZXdhYmlsaXR5ICcgK1xuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtyZW5kZXJSYW5nZSwgaXRlbUNvdW50fSksXG4gICAgICApO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBmb3IgKGxldCBpZHggPSBmaXJzdDsgaWR4IDw9IGxhc3Q7IGlkeCsrKSB7XG4gICAgICBjb25zdCBtZXRyaWNzID0gZ2V0RnJhbWVNZXRyaWNzKGlkeCwgcHJvcHMpO1xuICAgICAgaWYgKCFtZXRyaWNzKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgdG9wID0gbWV0cmljcy5vZmZzZXQgLSBzY3JvbGxPZmZzZXQ7XG4gICAgICBjb25zdCBib3R0b20gPSB0b3AgKyBtZXRyaWNzLmxlbmd0aDtcbiAgICAgIGlmICh0b3AgPCB2aWV3cG9ydEhlaWdodCAmJiBib3R0b20gPiAwKSB7XG4gICAgICAgIGZpcnN0VmlzaWJsZSA9IGlkeDtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIF9pc1ZpZXdhYmxlKFxuICAgICAgICAgICAgdmlld0FyZWFNb2RlLFxuICAgICAgICAgICAgdmlld2FibGVQZXJjZW50VGhyZXNob2xkLFxuICAgICAgICAgICAgdG9wLFxuICAgICAgICAgICAgYm90dG9tLFxuICAgICAgICAgICAgdmlld3BvcnRIZWlnaHQsXG4gICAgICAgICAgICBtZXRyaWNzLmxlbmd0aCxcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIHZpZXdhYmxlSW5kaWNlcy5wdXNoKGlkeCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZmlyc3RWaXNpYmxlID49IDApIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2aWV3YWJsZUluZGljZXM7XG4gIH1cblxuICAvKipcbiAgICogRmlndXJlcyBvdXQgd2hpY2ggaXRlbXMgYXJlIHZpZXdhYmxlIGFuZCBob3cgdGhhdCBoYXMgY2hhbmdlZCBmcm9tIGJlZm9yZSBhbmQgY2FsbHNcbiAgICogYG9uVmlld2FibGVJdGVtc0NoYW5nZWRgIGFzIGFwcHJvcHJpYXRlLlxuICAgKi9cbiAgb25VcGRhdGUoXG4gICAgcHJvcHM6IEZyYW1lTWV0cmljUHJvcHMsXG4gICAgc2Nyb2xsT2Zmc2V0OiBudW1iZXIsXG4gICAgdmlld3BvcnRIZWlnaHQ6IG51bWJlcixcbiAgICBnZXRGcmFtZU1ldHJpY3M6IChcbiAgICAgIGluZGV4OiBudW1iZXIsXG4gICAgICBwcm9wczogRnJhbWVNZXRyaWNQcm9wcyxcbiAgICApID0+ID97XG4gICAgICBsZW5ndGg6IG51bWJlcixcbiAgICAgIG9mZnNldDogbnVtYmVyLFxuICAgICAgLi4uXG4gICAgfSxcbiAgICBjcmVhdGVWaWV3VG9rZW46IChcbiAgICAgIGluZGV4OiBudW1iZXIsXG4gICAgICBpc1ZpZXdhYmxlOiBib29sZWFuLFxuICAgICAgcHJvcHM6IEZyYW1lTWV0cmljUHJvcHMsXG4gICAgKSA9PiBWaWV3VG9rZW4sXG4gICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZDogKHtcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICBjaGFuZ2VkOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgLi4uXG4gICAgfSkgPT4gdm9pZCxcbiAgICAvLyBPcHRpb25hbCBvcHRpbWl6YXRpb24gdG8gcmVkdWNlIHRoZSBzY2FuIHNpemVcbiAgICByZW5kZXJSYW5nZT86IHtcbiAgICAgIGZpcnN0OiBudW1iZXIsXG4gICAgICBsYXN0OiBudW1iZXIsXG4gICAgICAuLi5cbiAgICB9LFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBpdGVtQ291bnQgPSBwcm9wcy5nZXRJdGVtQ291bnQocHJvcHMuZGF0YSk7XG4gICAgaWYgKFxuICAgICAgKHRoaXMuX2NvbmZpZy53YWl0Rm9ySW50ZXJhY3Rpb24gJiYgIXRoaXMuX2hhc0ludGVyYWN0ZWQpIHx8XG4gICAgICBpdGVtQ291bnQgPT09IDAgfHxcbiAgICAgICFnZXRGcmFtZU1ldHJpY3MoMCwgcHJvcHMpXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxldCB2aWV3YWJsZUluZGljZXM6IEFycmF5PG51bWJlcj4gPSBbXTtcbiAgICBpZiAoaXRlbUNvdW50KSB7XG4gICAgICB2aWV3YWJsZUluZGljZXMgPSB0aGlzLmNvbXB1dGVWaWV3YWJsZUl0ZW1zKFxuICAgICAgICBwcm9wcyxcbiAgICAgICAgc2Nyb2xsT2Zmc2V0LFxuICAgICAgICB2aWV3cG9ydEhlaWdodCxcbiAgICAgICAgZ2V0RnJhbWVNZXRyaWNzLFxuICAgICAgICByZW5kZXJSYW5nZSxcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcy5sZW5ndGggPT09IHZpZXdhYmxlSW5kaWNlcy5sZW5ndGggJiZcbiAgICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcy5ldmVyeSgodiwgaWkpID0+IHYgPT09IHZpZXdhYmxlSW5kaWNlc1tpaV0pXG4gICAgKSB7XG4gICAgICAvLyBXZSBtaWdodCBnZXQgYSBsb3Qgb2Ygc2Nyb2xsIGV2ZW50cyB3aGVyZSB2aXNpYmlsaXR5IGRvZXNuJ3QgY2hhbmdlIGFuZCB3ZSBkb24ndCB3YW50IHRvIGRvXG4gICAgICAvLyBleHRyYSB3b3JrIGluIHRob3NlIGNhc2VzLlxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl92aWV3YWJsZUluZGljZXMgPSB2aWV3YWJsZUluZGljZXM7XG4gICAgaWYgKHRoaXMuX2NvbmZpZy5taW5pbXVtVmlld1RpbWUpIHtcbiAgICAgIGNvbnN0IGhhbmRsZTogVGltZW91dElEID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICAgKiBjb21tZW50IHN1cHByZXNzZXMgYW4gZXJyb3IgZm91bmQgd2hlbiBGbG93IHYwLjYzIHdhcyBkZXBsb3llZC4gVG9cbiAgICAgICAgICogc2VlIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgICAgdGhpcy5fdGltZXJzLmRlbGV0ZShoYW5kbGUpO1xuICAgICAgICB0aGlzLl9vblVwZGF0ZVN5bmMoXG4gICAgICAgICAgcHJvcHMsXG4gICAgICAgICAgdmlld2FibGVJbmRpY2VzLFxuICAgICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgICAgY3JlYXRlVmlld1Rva2VuLFxuICAgICAgICApO1xuICAgICAgfSwgdGhpcy5fY29uZmlnLm1pbmltdW1WaWV3VGltZSk7XG4gICAgICAvKiAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1jYWxsXSAoPj0wLjYzLjAgc2l0ZT1yZWFjdF9uYXRpdmVfZmIpIFRoaXNcbiAgICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUbyBzZWVcbiAgICAgICAqIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICAgIHRoaXMuX3RpbWVycy5hZGQoaGFuZGxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fb25VcGRhdGVTeW5jKFxuICAgICAgICBwcm9wcyxcbiAgICAgICAgdmlld2FibGVJbmRpY2VzLFxuICAgICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkLFxuICAgICAgICBjcmVhdGVWaWV3VG9rZW4sXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBjbGVhbi11cCBjYWNoZWQgX3ZpZXdhYmxlSW5kaWNlcyB0byBldmFsdWF0ZSBjaGFuZ2VkIGl0ZW1zIG9uIG5leHQgdXBkYXRlXG4gICAqL1xuICByZXNldFZpZXdhYmxlSW5kaWNlcygpIHtcbiAgICB0aGlzLl92aWV3YWJsZUluZGljZXMgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNvcmRzIHRoYXQgYW4gaW50ZXJhY3Rpb24gaGFzIGhhcHBlbmVkIGV2ZW4gaWYgdGhlcmUgaGFzIGJlZW4gbm8gc2Nyb2xsLlxuICAgKi9cbiAgcmVjb3JkSW50ZXJhY3Rpb24oKSB7XG4gICAgdGhpcy5faGFzSW50ZXJhY3RlZCA9IHRydWU7XG4gIH1cblxuICBfb25VcGRhdGVTeW5jKFxuICAgIHByb3BzOiBGcmFtZU1ldHJpY1Byb3BzLFxuICAgIHZpZXdhYmxlSW5kaWNlc1RvQ2hlY2s6IEFycmF5PG51bWJlcj4sXG4gICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZDogKHtcbiAgICAgIGNoYW5nZWQ6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICB2aWV3YWJsZUl0ZW1zOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgICAgLi4uXG4gICAgfSkgPT4gdm9pZCxcbiAgICBjcmVhdGVWaWV3VG9rZW46IChcbiAgICAgIGluZGV4OiBudW1iZXIsXG4gICAgICBpc1ZpZXdhYmxlOiBib29sZWFuLFxuICAgICAgcHJvcHM6IEZyYW1lTWV0cmljUHJvcHMsXG4gICAgKSA9PiBWaWV3VG9rZW4sXG4gICkge1xuICAgIC8vIEZpbHRlciBvdXQgaW5kaWNlcyB0aGF0IGhhdmUgZ29uZSBvdXQgb2YgdmlldyBzaW5jZSB0aGlzIGNhbGwgd2FzIHNjaGVkdWxlZC5cbiAgICB2aWV3YWJsZUluZGljZXNUb0NoZWNrID0gdmlld2FibGVJbmRpY2VzVG9DaGVjay5maWx0ZXIoaWkgPT5cbiAgICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcy5pbmNsdWRlcyhpaSksXG4gICAgKTtcbiAgICBjb25zdCBwcmV2SXRlbXMgPSB0aGlzLl92aWV3YWJsZUl0ZW1zO1xuICAgIGNvbnN0IG5leHRJdGVtcyA9IG5ldyBNYXAoXG4gICAgICB2aWV3YWJsZUluZGljZXNUb0NoZWNrLm1hcChpaSA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXdhYmxlID0gY3JlYXRlVmlld1Rva2VuKGlpLCB0cnVlLCBwcm9wcyk7XG4gICAgICAgIHJldHVybiBbdmlld2FibGUua2V5LCB2aWV3YWJsZV07XG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgY29uc3QgY2hhbmdlZCA9IFtdO1xuICAgIGZvciAoY29uc3QgW2tleSwgdmlld2FibGVdIG9mIG5leHRJdGVtcykge1xuICAgICAgaWYgKCFwcmV2SXRlbXMuaGFzKGtleSkpIHtcbiAgICAgICAgY2hhbmdlZC5wdXNoKHZpZXdhYmxlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCBba2V5LCB2aWV3YWJsZV0gb2YgcHJldkl0ZW1zKSB7XG4gICAgICBpZiAoIW5leHRJdGVtcy5oYXMoa2V5KSkge1xuICAgICAgICBjaGFuZ2VkLnB1c2goey4uLnZpZXdhYmxlLCBpc1ZpZXdhYmxlOiBmYWxzZX0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY2hhbmdlZC5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLl92aWV3YWJsZUl0ZW1zID0gbmV4dEl0ZW1zO1xuICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCh7XG4gICAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5LmZyb20obmV4dEl0ZW1zLnZhbHVlcygpKSxcbiAgICAgICAgY2hhbmdlZCxcbiAgICAgICAgdmlld2FiaWxpdHlDb25maWc6IHRoaXMuX2NvbmZpZyxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBfaXNWaWV3YWJsZShcbiAgdmlld0FyZWFNb2RlOiBib29sZWFuLFxuICB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQ6IG51bWJlcixcbiAgdG9wOiBudW1iZXIsXG4gIGJvdHRvbTogbnVtYmVyLFxuICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuICBpdGVtTGVuZ3RoOiBudW1iZXIsXG4pOiBib29sZWFuIHtcbiAgaWYgKF9pc0VudGlyZWx5VmlzaWJsZSh0b3AsIGJvdHRvbSwgdmlld3BvcnRIZWlnaHQpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgcGl4ZWxzID0gX2dldFBpeGVsc1Zpc2libGUodG9wLCBib3R0b20sIHZpZXdwb3J0SGVpZ2h0KTtcbiAgICBjb25zdCBwZXJjZW50ID1cbiAgICAgIDEwMCAqICh2aWV3QXJlYU1vZGUgPyBwaXhlbHMgLyB2aWV3cG9ydEhlaWdodCA6IHBpeGVscyAvIGl0ZW1MZW5ndGgpO1xuICAgIHJldHVybiBwZXJjZW50ID49IHZpZXdhYmxlUGVyY2VudFRocmVzaG9sZDtcbiAgfVxufVxuXG5mdW5jdGlvbiBfZ2V0UGl4ZWxzVmlzaWJsZShcbiAgdG9wOiBudW1iZXIsXG4gIGJvdHRvbTogbnVtYmVyLFxuICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuKTogbnVtYmVyIHtcbiAgY29uc3QgdmlzaWJsZUhlaWdodCA9IE1hdGgubWluKGJvdHRvbSwgdmlld3BvcnRIZWlnaHQpIC0gTWF0aC5tYXgodG9wLCAwKTtcbiAgcmV0dXJuIE1hdGgubWF4KDAsIHZpc2libGVIZWlnaHQpO1xufVxuXG5mdW5jdGlvbiBfaXNFbnRpcmVseVZpc2libGUoXG4gIHRvcDogbnVtYmVyLFxuICBib3R0b206IG51bWJlcixcbiAgdmlld3BvcnRIZWlnaHQ6IG51bWJlcixcbik6IGJvb2xlYW4ge1xuICByZXR1cm4gdG9wID49IDAgJiYgYm90dG9tIDw9IHZpZXdwb3J0SGVpZ2h0ICYmIGJvdHRvbSA+IHRvcDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBWaWV3YWJpbGl0eUhlbHBlcjtcbiJdLCJtYXBwaW5ncyI6IkFBVUEsWUFBWTs7QUFBQyxJQUFBQSxzQkFBQSxHQUFBQyxPQUFBO0FBQUEsSUFBQUMsZ0JBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFFLGVBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFHLGdCQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBSSxhQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxTQUFBSyxRQUFBQyxDQUFBLEVBQUFDLENBQUEsUUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLElBQUEsQ0FBQUosQ0FBQSxPQUFBRyxNQUFBLENBQUFFLHFCQUFBLFFBQUFDLENBQUEsR0FBQUgsTUFBQSxDQUFBRSxxQkFBQSxDQUFBTCxDQUFBLEdBQUFDLENBQUEsS0FBQUssQ0FBQSxHQUFBQSxDQUFBLENBQUFDLE1BQUEsV0FBQU4sQ0FBQSxXQUFBRSxNQUFBLENBQUFLLHdCQUFBLENBQUFSLENBQUEsRUFBQUMsQ0FBQSxFQUFB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